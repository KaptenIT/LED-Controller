#include <EEPROM.h>
#include <SPI.h>
#include <GD2.h>

static uint16_t valueR = 0;
static uint16_t valueG = 0;
static uint16_t valueB = 0;
static uint16_t options = 1;
long int store1 = 0x000000;
long int store2 = 0x000000;
long int store3 = 0x000000;
long int store4 = 0x000000;
long int store5 = 0x000000;

void setup() {
  Serial.begin(9600);
GD.begin();

//GD.cmd_loadimage(0,0);
//GD.load("healsky3.jpg");
}


#define White 0xFFFFFF
#define Green 0x00FF00
#define Blue  0x0000FF

#define Tag_Button1 101
#define Tag_Button2 102
#define Tag_Button3 103
#define Tag_Button4 104
#define Tag_Button5 105
#define Tag_SliderR 201
#define Tag_SliderG 202
#define Tag_SliderB 203

void loop() {
GD.get_inputs();

switch (GD.inputs.track_tag & 0xff){

  case Tag_SliderR:
  {
     valueR=GD.inputs.track_val;
      int valR = map(valueR, 0, 65535,0,255);
      //Serial.println(valR);
      printHexR(valR,2);
  }
  break;
  case Tag_SliderG:
  {
      valueG=GD.inputs.track_val;
       int valG = map(valueG, 0, 65535,0,255);
       printHex(valG,4);
  }
  break;
  case Tag_SliderB:
  {
     valueB=GD.inputs.track_val;
       int valB = map(valueB, 0, 65535,0,255);
    printHex(valB,6);
  }
  break;
}
if(GD.inputs.tag == 1)
{
  delay(500);
  if(GD.inputs.tag == 1)
  {
    store1 = 0xFFFF00;
   // lagra färgen
 
  }
  else  
  {
    //sätt färgen
 
  }
}

GD.Clear();

GD.Tag(Tag_Button1);
GD.cmd_fgcolor(store1);
CreateButton(400,4,75,50,28,"1", White);
GD.Tag(Tag_Button2);
GD.cmd_fgcolor(store2);
CreateButton(400,58,75,50,28,"2", White);;
GD.Tag(Tag_Button3);
GD.cmd_fgcolor(store3);
CreateButton(400,112,75,50,28,"3", White);
GD.Tag(Tag_Button4);
GD.cmd_fgcolor(store4);
CreateButton(400,166,75,50,28,"4", White);
GD.Tag(Tag_Button5);
GD.cmd_fgcolor(store5);
CreateButton(400,220,75,50,28,"5", White);


// Sliders
GD.cmd_fgcolor(0xFF0000);
GD.Tag(Tag_SliderR);
GD.cmd_slider(50, 30, 250, 20, options, valueR, 65535);
GD.cmd_track(50, 30, 250, 10, Tag_SliderR);

GD.cmd_fgcolor(0x00FF00);
GD.Tag(Tag_SliderG);
GD.cmd_slider(50, 130, 250, 20, options, valueG, 65535);
GD.cmd_track(50, 130, 250, 10, Tag_SliderG);

GD.cmd_fgcolor(0x0000FF);
GD.Tag(Tag_SliderB);
GD.cmd_slider(50, 230, 250, 20, options, valueB, 65535);
GD.cmd_track(50, 230, 250, 10, Tag_SliderB);




GD.swap();
}


void CreateButton(int posX, int posY, int Width, int Height, byte font, const char * text, long int Color ) { // skapar en knapp med position X, position Y, bredd, höjd, font typ, och string.
  
   GD.ColorRGB(Color);
 GD.Begin(RECTS);
  GD.cmd_button(posX, posY, Width, Height, font, options, text );
  }

 void printHexR(int num, int precision) {
     char tmp[16];
     char format[128];

     sprintf(format, "0x%%.%dX", precision);

     sprintf(tmp, format, num);
     Serial.print(tmp);
  }
  void printHex(int num, int precision) {
     char tmp[16];
     char format[128];

     sprintf(format, "%%.%dX", precision);

     sprintf(tmp, format, num);
     Serial.print(tmp);
  }
  
